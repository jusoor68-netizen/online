<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>رحلة «لمسة» الاستثمارية - نسخة متجاوبة للموبايل</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #F8FAFC;
            overflow-x: hidden; /* منع التمرير الأفقي */
        }
        .stage {
            width: 100%;
            /* جعل الارتفاع متجاوباً بناءً على نسبة العرض 16:9 تقريباً */
            aspect-ratio: 1000/650; 
            max-height: 80vh;
            position: relative;
            background: radial-gradient(circle at center, #ffffff 0%, #f1f5f9 100%);
            border-radius: 20px; /* تقليل الانحناء للموبايل */
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
        }
        .text-zone {
            position: absolute;
            bottom: 5%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            text-align: center;
            padding: 0 1rem;
        }
        #display-text {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            /* استخدام وحدات مرنة بدلاً من الثابتة */
            padding: 0.8rem 1.2rem;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            border: 1px solid rgba(255, 255, 255, 0.8);
            width: 95%; /* للموبايل */
            max-width: 600px; /* للكمبيوتر */
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* تصغير الخطوط في الموبايل */
        #caption-content {
            /* تم تصغير الحد الأدنى من 1.1rem إلى 0.9rem والنسبة المئوية */
            font-size: clamp(0.9rem, 3.5vw, 2.25rem); 
            line-height: 1.3;
        }
        .scene-group {
            opacity: 0;
            visibility: hidden;
        }
        .premium-shadow {
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
        }
        .flow-line {
            stroke-dasharray: 8, 8;
            stroke-linecap: round;
        }
        .value-particle {
            fill: #6366F1;
        }
        .control-btn {
            transition: all 0.3s ease;
        }
        .control-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-2 sm:p-4">

    <div class="max-w-4xl w-full text-center mb-4 sm:mb-6">
        <h1 class="text-xl sm:text-2xl font-black text-slate-900 mb-1">مشروع «لمسة» — جسر العبور الرقمي</h1>
        <p class="text-slate-500 font-medium text-xs sm:text-sm">متوافقة مع الجميع • تحكم كامل</p>
    </div>

    <div class="stage-container max-w-6xl w-full">
        <div id="main-stage" class="stage overflow-hidden border border-slate-100">
            
            <div class="text-zone">
                <div id="display-text" class="opacity-0">
                    <h2 id="caption-content" class="text-slate-900 font-black">
                        جاهز للعرض...
                    </h2>
                </div>
            </div>

            <div class="visual-zone h-full w-full">
                <svg id="svg-canvas" width="100%" height="100%" viewBox="0 0 1000 650" preserveAspectRatio="xMidYMid meet">
                    
                    <defs>
                        <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#FCD34D" />
                            <stop offset="50%" style="stop-color:#F59E0B" />
                            <stop offset="100%" style="stop-color:#B45309" />
                        </linearGradient>
                        <linearGradient id="indigoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#818CF8" />
                            <stop offset="100%" style="stop-color:#4F46E5" />
                        </linearGradient>
                        <filter id="glow-effect">
                            <feGaussianBlur stdDeviation="4" result="blur" />
                            <feMerge>
                                <feMergeNode in="blur" />
                                <feMergeNode in="SourceGraphic" />
                            </feMerge>
                        </filter>
                    </defs>

                    <!-- المشهد 1: المقدمة والمشاكل والـ POS -->
                    <g id="scene1" class="scene-group">
                        <rect x="100" y="480" width="800" height="15" rx="7" fill="#E2E8F0" />
                        
                        <!-- الشخصية بدون أيدي (في اليمين) -->
                        <g id="char-main" transform="translate(850, 400)">
                            <circle cx="0" cy="-60" r="35" fill="#1E293B" />
                            <path d="M-35 0 Q0 -45 35 0 V80 H-35 Z" fill="#4F46E5" />
                        </g>

                        <!-- الورقة النقدية 1000 -->
                        <g id="bill-1000" transform="translate(680, 360)" opacity="0">
                            <rect width="110" height="60" rx="6" fill="#059669" class="premium-shadow" />
                            <text x="55" y="40" text-anchor="middle" fill="white" font-size="22" font-weight="900">1000</text>
                        </g>

                        <!-- جهاز الـ POS (في أقصى اليسار) -->
                        <g id="pos-terminal" transform="translate(150, 420)" opacity="0">
                            <rect x="-45" y="-80" width="90" height="140" rx="12" fill="#1E293B" class="premium-shadow" />
                            <rect x="-35" y="-70" width="70" height="50" rx="4" fill="#0F172A" /> 
                            <circle id="nfc-light" cx="0" cy="-35" r="5" fill="#475569" />
                            <rect x="-30" y="5" width="60" height="40" rx="2" fill="#334155" opacity="0.4" />
                            <path id="check-pay" d="M-12 -35 L-2 -25 L12 -45" stroke="#22C55E" stroke-width="6" fill="none" opacity="0" stroke-linecap="round" />
                        </g>

                        <!-- بطاقة لمسة (تظهر محاذية للشخصية) -->
                        <g id="lamsa-card-tap" transform="translate(600, 100)" opacity="0">
                            <rect x="0" y="0" width="110" height="70" rx="10" fill="url(#indigoGrad)" class="premium-shadow" />
                            <text x="55" y="43" text-anchor="middle" fill="white" font-weight="bold" font-size="14">لمسة</text>
                        </g>
                        
                        <!-- أيقونة المشكلة (ساعة) -->
                        <g id="icons-s1" opacity="0">
                            <g transform="translate(880, 250)">
                                <circle r="30" fill="#FEE2E2" />
                                <path d="M0 -15 V0 H10" stroke="#EF4444" stroke-width="3" fill="none" />
                            </g>
                        </g>
                    </g>

                    <!-- المشهد 2: المظروف الموسط والتفعيل -->
                    <g id="scene2" class="scene-group">
                        <!-- المظروف الموسط تماماً -->
                        <g id="package-s2" transform="translate(500, 250)" opacity="0">
                            <rect x="-120" y="-80" width="240" height="160" rx="12" fill="white" stroke="#CBD5E1" stroke-width="2" class="premium-shadow" />
                            <path d="M-120 -80 L0 10 L120 -80" fill="#F8FAFC" stroke="#CBD5E1" stroke-width="2" />
                            <text y="55" text-anchor="middle" fill="#4F46E5" font-weight="900" font-size="18">Lamsa / لمسة</text>
                        </g>

                        <!-- البطاقة على الطاولة للمسح -->
                        <g id="scan-setup" transform="translate(500, 500)" opacity="0">
                            <rect x="-150" y="0" width="300" height="5" fill="#E2E8F0" />
                            <g id="card-on-table" transform="translate(0, -60)">
                                <rect x="-100" y="-65" width="200" height="130" rx="15" fill="#94A3B8" />
                                <rect x="30" y="-45" width="50" height="50" fill="#334155" id="qr-target" /> 
                                <path d="M35 -40 H75 M35 -20 H75 M35 0 H75" stroke="white" stroke-width="1.5" opacity="0.2" />
                            </g>
                        </g>

                        <!-- الهاتف وماسح الليزر -->
                        <g id="phone-scanner" transform="translate(500, 250)" opacity="0">
                            <rect x="-70" y="-130" width="140" height="260" rx="25" fill="#1E293B" class="premium-shadow" />
                            <rect x="-62" y="-105" width="124" height="210" rx="6" fill="#0F172A" />
                            <path id="laser-sweep" d="M-40 0 L40 0" stroke="#6366F1" stroke-width="4" filter="url(#glow-effect)" />
                        </g>

                        <!-- التحول الذهبي -->
                        <g id="gold-finale" transform="translate(500, 325)" opacity="0">
                            <rect x="-140" y="-90" width="280" height="180" rx="20" fill="url(#goldGrad)" class="premium-shadow" />
                            <text y="15" text-anchor="middle" fill="#854d0e" font-size="38" font-weight="900">لمسة</text>
                            <g id="lock-icon" opacity="0" transform="translate(0, -50)">
                                <rect x="-18" y="0" width="36" height="26" rx="4" fill="#854d0e" />
                                <path d="M-10 0 V-12 Q0 -22 10 -12 V0" stroke="#854d0e" stroke-width="4" fill="none" />
                            </g>
                        </g>
                    </g>

                    <!-- المشهد 3: البوابة الموحدة -->
                    <g id="scene3" class="scene-group">
                        <circle cx="580" cy="320" r="105" fill="#EEF2FF" />
                        <circle id="hub-main" cx="580" cy="320" r="85" fill="url(#indigoGrad)" filter="url(#glow-effect)" />
                        <text x="580" y="328" text-anchor="middle" fill="white" font-weight="900" font-size="22">البوابة</text>
                        
                        <path id="p1" d="M280 150 C380 150 480 250 530 300" stroke="#CBD5E1" stroke-width="4" fill="none" class="flow-line" />
                        <path id="p2" d="M280 320 H500" stroke="#CBD5E1" stroke-width="4" fill="none" class="flow-line" />
                        <path id="p3" d="M280 490 C380 490 480 390 530 340" stroke="#CBD5E1" stroke-width="4" fill="none" class="flow-line" />

                        <g transform="translate(220, 150)" class="icon-box" opacity="0">
                            <rect x="-40" y="-40" width="80" height="80" rx="15" fill="#1E293B"/><text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="13">البنوك</text>
                        </g>
                        <g transform="translate(220, 320)" class="icon-box" opacity="0">
                            <rect x="-40" y="-40" width="80" height="80" rx="15" fill="#4F46E5"/><text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="13">المحافظ</text>
                        </g>
                        <g transform="translate(220, 490)" class="icon-box" opacity="0">
                            <rect x="-40" y="-40" width="80" height="80" rx="15" fill="#0EA5E9"/><text y="6" text-anchor="middle" fill="white" font-weight="bold" font-size="11">الوكلاء والبقالة</text>
                        </g>

                        <g id="stream-container"></g>
                    </g>
                </svg>
            </div>
        </div>
    </div>

    <!-- التحكم -->
    <div class="mt-6 sm:mt-8 flex flex-col items-center gap-4 sm:gap-6 w-full max-w-6xl">
        <div class="flex gap-4 w-full justify-center">
            <button id="play-btn" onclick="startShow()" class="control-btn bg-indigo-600 hover:bg-indigo-700 text-white px-6 sm:px-10 py-3 sm:py-5 rounded-2xl sm:rounded-3xl font-black text-sm sm:text-xl shadow-xl active:scale-95 w-1/2 sm:w-auto">
                بدأ العرض
            </button>
            <button id="pause-btn" onclick="togglePause()" class="control-btn bg-slate-200 hover:bg-slate-300 text-slate-700 px-6 sm:px-10 py-3 sm:py-5 rounded-2xl sm:rounded-3xl font-black text-sm sm:text-xl shadow-md active:scale-95 hidden w-1/2 sm:w-auto">
                إيقاف مؤقت
            </button>
        </div>
        
        <div class="flex items-center gap-4 sm:gap-6 bg-white px-4 sm:px-8 py-2 sm:py-3 rounded-full border border-slate-100 shadow-sm w-full sm:w-[600px] justify-between">
            <span id="timer" class="text-slate-400 font-mono text-xs sm:text-sm font-bold min-w-[40px]">00:00</span>
            <div class="flex-1 h-2 sm:h-3 bg-slate-100 rounded-full overflow-hidden mx-2">
                <div id="master-progress" class="h-full bg-indigo-600 w-0"></div>
            </div>
            <span id="label" class="text-indigo-600 font-black text-[10px] sm:text-xs uppercase tracking-widest whitespace-nowrap">مستعد</span>
        </div>
    </div>

    <script>
        let tl = gsap.timeline({ paused: true });
        let isPaused = false;

        function updateCaptions(text, color = "#0f172a") {
            const container = document.getElementById('display-text');
            const content = document.getElementById('caption-content');
            gsap.to(container, { opacity: 0, y: 10, duration: 0.3, onComplete: () => {
                content.innerText = text;
                content.style.color = color;
                gsap.to(container, { opacity: 1, y: 0, duration: 0.5 });
            }});
        }

        function createStream(pathId) {
            const container = document.getElementById('stream-container');
            const path = document.getElementById(pathId);
            const pathLength = path.getTotalLength();
            
            for(let i=0; i<3; i++) {
                const dot = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                dot.setAttribute("r", "5");
                dot.classList.add("value-particle");
                container.appendChild(dot);
                
                gsap.fromTo(dot, {opacity: 0}, {
                    opacity: 1, duration: 2, repeat: -1, delay: i * 0.7,
                    onUpdate: function() {
                        const pt = path.getPointAtLength(this.progress() * pathLength);
                        dot.setAttribute("cx", pt.x);
                        dot.setAttribute("cy", pt.y);
                    }
                });
            }
        }

        function togglePause() {
            isPaused = !isPaused;
            tl.paused(isPaused);
            document.getElementById('pause-btn').innerText = isPaused ? "استئناف" : "إيقاف مؤقت";
        }

        function startShow() {
            reset();
            buildTimeline();
            tl.play();
            document.getElementById('play-btn').innerText = "إعادة التشغيل";
            document.getElementById('pause-btn').classList.remove('hidden');
            isPaused = false;
        }

        function reset() {
            if(tl) tl.kill();
            gsap.set(".scene-group", { opacity: 0, visibility: "hidden" });
            gsap.set("#display-text", { opacity: 0 });
            gsap.set("#check-pay", { opacity: 0 });
            gsap.set("#nfc-light", { fill: "#475569" });
            gsap.set("#lamsa-card-tap", { x: 0, y: 0, rotate: 0, opacity: 0 });
            document.getElementById('stream-container').innerHTML = "";
        }

        function buildTimeline() {
            tl = gsap.timeline({
                onUpdate: function() {
                    const p = this.progress() * 100;
                    document.getElementById('master-progress').style.width = p + '%';
                    const s = Math.floor(this.time());
                    document.getElementById('timer').innerText = `0${Math.floor(s/60)}:${(s%60).toString().padStart(2, '0')}`;
                },
                onComplete: () => { document.getElementById('pause-btn').classList.add('hidden'); }
            });

            // --- مشهد 1: المقدمة والمشاكل (0-35ث) ---
            tl.add(() => {
                document.getElementById('label').innerText = "المشهد 1: الأزمات اليومية";
                gsap.set("#scene1", { opacity: 1, visibility: "visible" });
                updateCaptions("ماعندك نت ونسيت الكاش في البيت؟");
            }, 0);

            tl.to("#char-main", { x: "+=3", repeat: 40, yoyo: true, duration: 0.1 }, 1);
            
            tl.add(() => updateCaptions("أو رصيدك مشتت في أكثر من محفظة.. وصعب تجمعه؟"), 6);
            tl.add(() => updateCaptions("بالإضافة لانتظار الفكة المزعج عند الكاشير..."), 12);
            tl.add(() => updateCaptions("كل هذا فعلاً يبطّئ يومك."), 18);

            tl.to("#bill-1000", { opacity: 1, scale: 1.1, duration: 1 }, 19);
            tl.to("#icons-s1", { opacity: 1, duration: 0.8 }, 20);

            // ظهور الحل والـ POS
            tl.to("#bill-1000", { opacity: 0, duration: 0.6 }, 25);
            tl.to("#lamsa-card-tap", { opacity: 1, x: 730, y: 380, duration: 1, ease: "back.out" }, 26);
            tl.add(() => updateCaptions("الحل: بطاقة «لمسة» للدفع الفوري", "#4F46E5"), 27);
            
            tl.to("#pos-terminal", { opacity: 1, duration: 0.8 }, 29);
            tl.add(() => updateCaptions("مرّر البطاقة على جهاز الـ POS."), 30);
            
            // تمرير واقعي نحو الـ POS في اليسار
            tl.to("#lamsa-card-tap", { x: 150, y: 380, rotate: 20, duration: 1.5, ease: "power3.inOut" }, 31);
            tl.to("#nfc-light", { fill: "#22C55E", filter: "url(#glow-effect)", duration: 0.2 }, 32.2);
            tl.to("#check-pay", { opacity: 1, duration: 0.4 }, 32.4);
            tl.add(() => updateCaptions("ثوانٍ… وتم الدفع بنجاح وبدون إنترنت.", "#059669"), 33);

            // --- مشهد 2: التفعيل الرقمي (36-65ث) ---
            tl.add(() => {
                document.getElementById('label').innerText = "المشهد 2: تفعيل البطاقة";
                gsap.to("#scene1", { opacity: 0, duration: 0.6 });
                gsap.set("#scene2", { opacity: 1, visibility: "visible" });
                updateCaptions("احصل عليها بسهولة من أقرب وكيل.");
            }, 38);

            // المظروف الموسط
            tl.to("#package-s2", { opacity: 1, y: 150, duration: 1.2, ease: "back.out" }, 40);
            tl.add(() => updateCaptions("تصلك وفيها باقة ترحيبية جاهزة للاستخدام."), 46);
            
            // قراءة QR
            tl.to("#package-s2", { opacity: 0, duration: 0.5 }, 51);
            tl.to("#scan-setup", { opacity: 1, duration: 0.8 }, 52);
            tl.to("#phone-scanner", { opacity: 1, y: 120, duration: 1, ease: "back.out" }, 53);
            tl.add(() => updateCaptions("امسح رمز QR من خلف البطاقة للتفعيل."), 54);
            tl.fromTo("#laser-sweep", {y: -40}, {y: 40, repeat: 4, yoyo: true, duration: 0.7}, 55);

            // إضافة خطوة CVV
            tl.add(() => updateCaptions("خصص بطاقتك عبر إدخال رمز الـ CVV"), 60);
            
            tl.to(["#scan-setup", "#phone-scanner"], { opacity: 0, duration: 0.6 }, 63);
            tl.to("#gold-finale", { opacity: 1, scale: 1.1, duration: 1 }, 64);
            tl.to("#lock-icon", { opacity: 1, y: 0, duration: 0.8 }, 66);
            tl.add(() => updateCaptions("بطاقتك الآن محمية، وموثقة برقمك فقط.", "#B45309"), 67);

            // --- مشهد 3: بوابة الشحن (66-90ث) ---
            tl.add(() => {
                document.getElementById('label').innerText = "المشهد 3: بوابة الشحن";
                gsap.to("#scene2", { opacity: 0, duration: 0.6 });
                gsap.set("#scene3", { opacity: 1, visibility: "visible" });
                updateCaptions("بوابة شحن موحدة… لكل أموالك.");
            }, 72);

            tl.to(".icon-box", { opacity: 1, stagger: 0.3, duration: 0.7 }, 74);
            tl.add(() => {
                createStream("p1");
                createStream("p2");
                createStream("p3");
            }, 76);

            tl.add(() => updateCaptions("اشحن من حسابك البنكي أو المحافظ الإلكترونية."), 79);
            tl.add(() => updateCaptions("أو عبر الوكلاء المعتمدين وحتى من البقالة."), 85);
            tl.add(() => updateCaptions("لمسة: جسر العبور للاقتصاد الرقمي.", "#4F46E5"), 89);

            tl.to({}, { duration: 1 }, 90);
        }

        window.onload = reset;
    </script>
</body>
</html>
